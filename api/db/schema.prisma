datasource db {
  provider = "mongodb"
  url      = env("DATABASE_URL")
}

generator client {
  provider        = "prisma-client-js"
  previewFeatures = ["mongoDb"]
  binaryTargets   = "native"
}

// Define your own datamodels here and run `yarn redwood prisma migrate dev`
// to create migrations for them and apply to your dev DB.
// TODO: Please remove the following example:
model User {
  id                 String            @id @default(dbgenerated()) @map("_id") @db.ObjectId
  username           String            @unique
  firstName          String
  lastName           String
  email              String?
  peerId             String?
  room               Room?             @relation(fields: [roomId], references: [id])
  category           Category?         @relation(fields: [categoryId], references: [id])
  areasOfExpertise   AreaOfExpertise[] @relation(fields: [areaofExpertiseIds])
  areaofExpertiseIds String[]          @db.Array(ObjectId)
  role               Role              @default(AUDIENCE)
  roomId             String?           @db.ObjectId
  categoryId         String            @db.ObjectId
}

enum Role {
  HOST
  COHOST
  SPEAKER
  AUDIENCE
}

model Room {
  id           String   @id @default(dbgenerated()) @map("_id") @db.ObjectId
  name         String   @unique
  title        String
  createdAt    DateTime @default(now())
  participants User[]
}

model Category {
  id    String @id @default(dbgenerated()) @map("_id") @db.ObjectId
  name  String @unique
  users User[]
}

model AreaOfExpertise {
  id      String   @id @default(dbgenerated()) @map("_id") @db.ObjectId
  name    String   @unique
  userIds String[] @db.Array(ObjectId)
  users   User[]   @relation(fields: [userIds])
}
